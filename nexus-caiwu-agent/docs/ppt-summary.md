# PPT 生成功能总结

## 当前状态

### ✅ 已实现功能

1. **本地 PPT 生成**
   - 使用 python-pptx 库
   - 使用 matplotlib 生成图表
   - 10页完整财报分析PPT
   - 3张可视化图表：
     * 健康评分仪表盘（圆形进度条）
     * 五维度雷达图
     * 行业对比条形图

2. **文件输出位置**
   ```
   d:/caiwu_skill/nexus-caiwu-agent/reports/
   ├── [股票代码]_financial_report.html    # HTML交互式报告
   ├── [股票代码]_financial_report.pptx    # PPT报告（本地生成）
   ```

3. **使用方式**
   ```bash
   python scripts/fetch_data.py 002415 海康威视 --analyze --enhance --ppt
   ```

### ⚠️ 已知限制

1. **中文字体显示**
   - 图表中的中文可能显示为方块 ⬜
   - 不影响图表数据可视化效果
   - 可以在PPT中手动调整字体

2. **模板样式**
   - 本地生成使用简洁样式，无精美模板
   - 如需专业模板，请使用百度 AI PPT skill（手动调用）

3. **图表类型**
   - 当前包含：仪表盘、雷达图、条形图
   - HTML报告包含更多交互式图表（D3.js）

## 关于百度 AI PPT Skill

### 为什么不直接集成？

1. **API限制**
   - clawhub.ai API 需要认证
   - 生成时间较长（30-60秒）
   - 需要处理异步生成和文件下载

2. **当前实现优势**
   - 快速生成（10秒）
   - 无需外部依赖
   - 数据实时准确
   - 可控性强

3. **AI PPT Skill 用法**

如需使用百度 AI 生成的精美模板PPT，请在 Claude Code 中直接调用：

```
使用 ai-ppt-generator 生成一份"海康威视(002415)财务分析报告"PPT

风格：商务风格
页数：10页左右
包含：
- 健康评分：82/100
- 营业收入：657.5亿元
- 净利润：102.5亿元
- 净利率：15.59%
- ROE：11.93%
- 风险等级：低风险
- 建议：财务状况优异
```

## 中文字体修复（可选）

如需修复图表中文字体显示：

### 方法1：安装中文字体包
```bash
pip install seaborn -q
```

### 方法2：在生成后手动调整
1. 打开生成的 PPT
2. 选中图表
3. 右键 → 编辑文字
4. 手动设置字体为"微软雅黑"或"黑体"

### 方法3：使用系统字体
确保 Windows 系统已安装：
- Microsoft YaHei（微软雅黑）
- SimHei（黑体）
- SimSun（宋体）

## 文件对比

| 特性 | HTML报告 | 本地PPT | 百度AI PPT |
|------|---------|---------|-----------|
| 交互式图表 | ✅ D3.js | ❌ 静态 | ❌ 静态 |
| 精美模板 | ⚠️ 基础 | ❌ 简洁 | ✅ 专业 |
| 中文字体 | ✅ 完美 | ⚠️ 方块 | ✅ 完美 |
| 生成速度 | ✅ 快 | ✅ 快（10s） | ⚠️ 慢（30-60s） |
| 数据准确性 | ✅ 实时 | ✅ 实时 | ⚠️ 生成时 |
| 便利性 | ⚠️ 需浏览器 | ✅ PPT软件 | ✅ PPT软件 |

## 推荐使用场景

### 使用 HTML 报告
- 需要交互式数据探索
- 需要详细的多维度分析
- 需要实时数据更新

### 使用本地 PPT
- 需要快速生成演示文稿
- 需要离线分享
- 需要在PPT中进一步编辑

### 使用百度 AI PPT
- 需要专业精美的模板
- 需要AI智能排版和配图
- 有充足的生成时间（30-60秒）

## 未来优化方向

1. **修复中文字体**
   - 配置 matplotlib 正确加载中文字体
   - 或使用 Pillow 添加中文字体渲染

2. **集成百度 AI API**
   - 实现异步调用 clawhub.ai API
   - 自动下载生成的PPT文件

3. **添加更多图表**
   - 现金流趋势图
   - 杜邦分析图
   - 多年对比图

4. **自定义模板**
   - 支持用户上传PPT模板
   - 基于模板填充数据
