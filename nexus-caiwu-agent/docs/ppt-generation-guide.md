# 财务分析 PPT 生成指南

## 功能概述

本系统提供两种方式生成财报分析PPT：

### 方式一：本地生成（当前实现）

**特点**：
- ✅ 已集成，开箱即用
- ✅ 包含 matplotlib 图表（仪表盘、雷达图、条形图）
- ✅ 支持中文字体
- ✅ 快速生成（约10秒）

**生成命令**：
```bash
python scripts/fetch_data.py 002415 海康威视 --analyze --enhance --ppt
```

**PPT结构（10页）**：
1. 封面 - 公司名称、股票代码、日期
2. 公司概况 - 基本信息、所属行业
3. 核心财务指标 - 营收、利润、盈利能力
4. 健康评分分析 - 仪表盘图 + 雷达图 📊
5. 行业对比分析 - 条形图 📊
6. 盈利能力分析 - 净利率、ROE解读
7. 投资建议 - 综合建议
8. 风险提示 - 免责声明

### 方式二：百度 AI PPT Skill（需手动调用）

**特点**：
- ✅ 专业模板和配色
- ✅ AI智能排版
- ✅ 自动配图
- ⚠️ 需要手动调用或集成API

**调用方法**：

#### 方法1：在 Claude Code 中直接调用

```
使用 ai-ppt-generator 生成一份"海康威视(002415)财务分析报告"PPT

内容要点：
- 健康评分：82/100，低风险
- 营业收入：657.5亿元
- 净利润：102.5亿元
- 净利率：15.59%
- ROE：11.93%
- 风险等级：低风险
- 建议：财务状况优异，可持续关注

风格：商务风格，包含数据图表
```

#### 方法2：通过 clawhub.ai API（需要集成）

```python
import requests

# 调用百度 AI PPT skill
response = requests.post(
    "https://clawhub.ai/ide-rea/ai-ppt-generator",
    json={
        "prompt": "生成商务风格PPT，主题：海康威视财务分析...",
        "style": "商务"
    },
    timeout=120
)

result = response.json()
# 下载生成的PPT文件
```

---

## 中文字体配置

matplotlib 已配置支持中文，使用的字体优先级：
1. Microsoft YaHei（微软雅黑）
2. SimHei（黑体）
3. KaiTi（楷体）
4. FangSong（仿宋）
5. SimSun（宋体）

如果图表中中文仍显示为方块，请确保系统已安装上述字体。

---

## 生成的文件位置

所有报告统一保存在：
```
d:/caiwu_skill/nexus-caiwu-agent/reports/
├── [股票代码]_financial_report.html    # HTML报告
├── [股票代码]_financial_report.pptx    # PPT报告（本地生成）
└── [股票代码]_ai_financial_report.pptx  # PPT报告（AI生成，需手动）
```

---

## 对比：HTML vs PPT

| 特性 | HTML报告 | PPT报告（本地） | PPT报告（AI） |
|------|---------|----------------|--------------|
| 交互式图表 | ✅ D3.js | ❌ 静态图片 | ❌ 静态图片 |
| 模板设计 | ✅ 专业 | ⚠️ 简洁 | ✅ 精美 |
| 数据实时性 | ✅ 实时 | ✅ 实时 | ⚠️ 生成时 |
| 分享便利性 | ⚠️ 需浏览器 | ✅ 直接打开 | ✅ 直接打开 |
| 编辑便利性 | ⚠️ 需代码 | ⚠️ 需PPT软件 | ⚠️ 需PPT软件 |
| 生成速度 | ✅ 快 | ✅ 快（10秒） | ⚠️ 慢（30-60秒） |

---

## 常见问题

### Q1: PPT中的图表中文显示为方块？
A: 确保 Windows 系统已安装中文字体。如仍有问题，可在 PPT 中手动更改字体。

### Q2: 如何使用百度AI生成带模板的PPT？
A: 参考"方式二"中的调用方法，或直接在 Claude Code 中使用 ai-ppt-generator skill。

### Q3: 本地生成的PPT可以添加模板吗？
A: 可以。在生成的PPT中：
1. 设计 → 幻灯片大小 → 页面设置
2. 设计 → 变体 → 主题
3. 手动应用模板

### Q4: 为什么不直接集成百度AI API？
A:
- API需要认证和网络访问
- AI生成时间较长（30-60秒）
- 需要处理异步生成和文件下载
- 当前本地生成已满足基本需求

---

## 未来改进方向

1. **集成百度AI API**：实现真正的AI模板PPT生成
2. **更多图表类型**：添加现金流趋势、杜邦分析等
3. **自定义模板**：支持用户上传PPT模板
4. **批量生成**：支持批量生成多只股票的PPT
